
CREDITS_SCROLL_RATE = 40;
CREDITS_FADE_RATE = 0.4;
--CREDITS_MAX_ALPHA = 0.7;
NUM_CREDITS_ART_TEXTURES_WIDE = 4;
NUM_CREDITS_ART_TEXTURES_HIGH = 2;
CACHE_WAIT_TIME = 0.5;

CreditsArtInfo = {};
CreditsArtInfo[1] = {};
CreditsArtInfo[1][1] = { file="Acrest", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][2] = { file="Tauren", w=640, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][3] = { file="Centaur", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][4] = { file="HordeBanner", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][5] = { file="Naga", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.4 };
CreditsArtInfo[1][6] = { file="NightsHollow", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][7] = { file="Ocean", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][8] = { file="Orc", w=256, h=512, offsetx=192, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][9] = { file="Strangle", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][10] = { file="Troll", w=640, h=512, offsetx=0, offsety=0, maxAlpha=0.6 };
CreditsArtInfo[1][11] = { file="TrollBanner", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][12] = { file="Zepplin", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][13] = { file="drake", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][14] = { file="DwarfCrest", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][15] = { file="Dwarfhunter", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.6 };
CreditsArtInfo[1][16] = { file="gargoyle", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][17] = { file="NightelfCrest", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][18] = { file="Nightelves", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][19] = { file="Orccamp", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][20] = { file="DragonIsles", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][21] = { file="tauren_hunter", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][22] = { file="Darnasis", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][23] = { file="ForsakenCrest", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][24] = { file="ShootingDwarf", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.6 };
CreditsArtInfo[1][25] = { file="Thunderbluff", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][26] = { file="tolbarad", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][27] = { file="TaurenCrest", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][28] = { file="razorfen", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][29] = { file="swampofsorrows", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][30] = { file="Desolace", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][31] = { file="SouthernDesolace", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][32] = { file="undeadcrest", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[1][33] = { file="TirisfallGlades", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][34] = { file="ThousandNeedles", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][35] = { file="Elemental", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][36] = { file="Badlands", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][37] = { file="BlastedLands", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][38] = { file="Fellwood", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[1][39] = { file="OrcShield", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.5 };
CreditsArtInfo[2] = {};
CreditsArtInfo[2][1] = { file="BD", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][2] = { file="Wrathguard", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][3] = { file="WOW_BloodElves", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][4] = { file="ZulAman", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][5] = { file="Arakkoa", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][6] = { file="Hellfire_Concept", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][7] = { file="Auchindoun", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][8] = { file="Auchindoun_1H", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][9] = { file="1H_Axes", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][10] = { file="BE_Building", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][11] = { file="BE_Building_Two", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][12] = { file="BladesEdge", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][13] = { file="BladesEdgeMountains", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][14] = { file="Blood_Elf_One", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][15] = { file="BloodElf_Female", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][16] = { file="BloodElf_Icon", w=512, h=512, offsetx=128, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][17] = { file="BloodElf_Priestess_Master", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][18] = { file="BloodElf_Two", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][19] = { file="BloodElf_Webimage", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][20] = { file="Clefthoof_3_horn", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][21] = { file="1000px-Coilfangpaintover", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][22] = { file="Dark_Portal", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][23] = { file="Ddraenei_Start", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][24] = { file="Demon_Chamber", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][25] = { file="Draenei", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][26] = { file="Draenei_Character", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][27] = { file="Draenei_CityInt", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][28] = { file="Draenei_Crest", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][29] = { file="Draenei_Female", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][30] = { file="Draenei_Paladin", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][31] = { file="Draenei_Three", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][32] = { file="Draenei_Two", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][33] = { file="Dranei_F_Hair", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][34] = { file="Dranei_M_Hair", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][35] = { file="Elekk", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][36] = { file="Female_BloodElf", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][37] = { file="FungalGiant", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][38] = { file="Arcane_Golem", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][39] = { file="Human_Mage", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][40] = { file="HumanMale", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][41] = { file="Hunter", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][42] = { file="Illidan", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][43] = { file="Illidan_Concept", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][44] = { file="Outland", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][45] = { file="MilitaryOrcBoss", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][46] = { file="Naaru_CrashSite", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][47] = { file="Naaru_Ship", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][48] = { file="Ogre_Lord", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][49] = { file="Shivan", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][50] = { file="L60ETC", w=512, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][51] = { file="RazorfenDowns", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][52] = { file="RidingDrake", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][53] = { file="Shattrath", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][54] = { file="Tier4_Druid", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][55] = { file="Silvermoon_Day", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][56] = { file="Silvermoon_Tower", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][57] = { file="Tempest_Keep", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][58] = { file="Terrokkar", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][59] = { file="The_Broken", w=768, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };
CreditsArtInfo[2][60] = { file="Photos", w=1024, h=512, offsetx=0, offsety=0, maxAlpha=0.7 };


function CreditsFrame_OnShow()
	-- Set Switch Button
	local  expansion = GetClientExpansionLevel();
	if ( expansion == 1 ) then
		CreditsFrameSwitchButton:Hide();
	elseif ( expansion == 2 ) then
		CreditsFrameSwitchButton:Show();
	end
	
	CreditsFrame_Update();
end

function CreditsFrame_Update()
	CreditsScrollFrame:SetVerticalScroll(0);
	CreditsScrollFrame:UpdateScrollChildRect();
	CreditsScrollFrame.scroll = 0;
	CreditsScrollFrame.scrollMax = CreditsScrollFrame:GetVerticalScrollRange() + 768;
	this.artCount = getn(CreditsArtInfo[CreditsFrame.creditsType]);
	this.currentArt = 0;
	this.fadingIn = nil;
	this.fadingOut = nil;
	this.cacheArt = 0;
	this.cacheIndex = 1;
	this.cacheElapsed = 0;
	this.alphaIn = 0;
	this.alphaOut = 0;
	
	for i=1, NUM_CREDITS_ART_TEXTURES_HIGH, 1 do
		for j=1, NUM_CREDITS_ART_TEXTURES_WIDE, 1 do
			getglobal("CreditsArtAlt"..(((i - 1) * NUM_CREDITS_ART_TEXTURES_WIDE) + j)):Hide();
			getglobal("CreditsArtCache"..(((i - 1) * NUM_CREDITS_ART_TEXTURES_WIDE) + j)):SetAlpha(0.005);
		end
	end

	CreditsFrame_CacheTextures(1);

	-- Set Credits Text
	CreditsText:SetText(GetCreditsText(CreditsFrame.creditsType));

	-- Set BC logo
	SetLogo(CreditsFrame.creditsType);
	
	-- Set Switch Button Text
	if ( CreditsFrame.creditsType == 2 ) then
		CreditsFrameSwitchButton:SetText(CREDITS_WOW_CLASSIC);
	elseif ( CreditsFrame.creditsType == 1 ) then
		CreditsFrameSwitchButton:SetText(CREDITS_WOW_BC);
	end
end

function CreditsFrame_Switch()
	if ( CreditsFrame.creditsType == 2 ) then
		CreditsFrame.creditsType = 1;
		CreditsFrame_Update();
	else
		CreditsFrame.creditsType = 2;
		CreditsFrame_Update();
	end
	SetGlueScreen("credits");	
end

function CreditsFrame_SetArtTextures(textureName, index, alpha)
	local info = CreditsArtInfo[this.creditsType][index];
	if ( not info ) then
		return;
	end

	local texture;
	local texIndex = 1;
	local width, height;
	getglobal(textureName..1):SetPoint("TOPLEFT", "CreditsFrame", "TOPLEFT", info.offsetx, info.offsety - 128);
	for i=1, NUM_CREDITS_ART_TEXTURES_HIGH, 1 do
		height = info.h - ((i - 1) * 256);
		if ( height > 256 ) then
			height = 256;
		end
		for j=1, NUM_CREDITS_ART_TEXTURES_WIDE, 1 do
			texture = getglobal(textureName..(((i - 1) * NUM_CREDITS_ART_TEXTURES_WIDE) + j));
			width = info.w - ((j - 1) * 256);
			if ( width > 256 ) then
				width = 256;
			end
			if ( (width <= 0) or (height <= 0) ) then
				texture:Hide();
			else
				texture:SetTexture("Interface\\Glues\\Credits\\"..info.file..texIndex);
				texture:SetWidth(width);
				texture:SetHeight(height);
				texture:SetAlpha(alpha);
				texture:Show();
				texIndex = texIndex + 1;
			end
		end
	end
end

function CreditsFrame_CacheTextures(index)
	this.cacheArt = index;
	this.cacheIndex = 1;
	this.cacheElapsed = 0;

	local info = CreditsArtInfo[CreditsFrame.creditsType][index];
	if ( not info ) then
		return;
	end

	CreditsArtCache1:SetTexture("Interface\\Glues\\Credits\\"..info.file.."1");
end

function CreditsFrame_UpdateCache()
	if ( this.cacheIndex >= (NUM_CREDITS_ART_TEXTURES_WIDE * NUM_CREDITS_ART_TEXTURES_HIGH) ) then
		return;
	end
	if ( this.cacheElapsed < CACHE_WAIT_TIME ) then
		return;
	end

	this.cacheElapsed = this.cacheElapsed - CACHE_WAIT_TIME;
	this.cacheIndex = this.cacheIndex + 1;

	local info = CreditsArtInfo[this.creditsType][this.cacheArt];
	if ( not info ) then
		return;
	end

	getglobal("CreditsArtCache"..this.cacheIndex):SetTexture("Interface\\Glues\\Credits\\"..info.file..this.cacheIndex);
end

function CreditsFrame_UpdateArt(index, elapsed)
	if (index > (this.currentArt + 1) ) then
		return;
	end

	if ( index == this.currentArt ) then
		if ( this.fadingOut ) then
			this.alphaOut = max(this.alphaOut - (CREDITS_FADE_RATE * elapsed), 0);

			for i=1, NUM_CREDITS_ART_TEXTURES_HIGH, 1 do
				for j=1, NUM_CREDITS_ART_TEXTURES_WIDE, 1 do
					getglobal("CreditsArtAlt"..(((i - 1) * NUM_CREDITS_ART_TEXTURES_WIDE) + j)):SetAlpha(this.alphaOut);
				end
			end

			if ( this.alphaOut <= 0 ) then
				this.fadingOut = nil;
				CreditsFrame_CacheTextures(this.currentArt + 1);
			end
		end

		if ( this.fadingIn ) then
			local maxAlpha = CreditsArtInfo[this.creditsType][this.currentArt].maxAlpha;
			this.alphaIn = min(this.alphaIn + (CREDITS_FADE_RATE * elapsed), maxAlpha);
			for i=1, NUM_CREDITS_ART_TEXTURES_HIGH, 1 do
				for j=1, NUM_CREDITS_ART_TEXTURES_WIDE, 1 do
					getglobal("CreditsArt"..(((i - 1) * NUM_CREDITS_ART_TEXTURES_WIDE) + j)):SetAlpha(this.alphaIn);
				end
			end

			if ( this.alphaIn >= maxAlpha ) then
				this.fadingIn = nil;
			end
		end
		return;
	end

	if ( this.currentArt > 0 ) then
		this.fadingOut = 1;
		this.alphaOut = CreditsArtInfo[this.creditsType][this.currentArt].maxAlpha;
		CreditsFrame_SetArtTextures("CreditsArtAlt", this.currentArt, this.alphaOut);
	end

	this.fadingIn = 1;
	this.alphaIn = 0;
	this.currentArt = index;
	CreditsFrame_SetArtTextures("CreditsArt", index, this.alphaIn);
end

function CreditsFrame_OnUpdate(elapsed)
	if ( not CreditsScrollFrame:IsVisible() ) then
		return;
	end

	CreditsScrollFrame.scroll = CreditsScrollFrame.scroll + (CREDITS_SCROLL_RATE * elapsed);
	if ( CreditsScrollFrame.scroll >= CreditsScrollFrame.scrollMax ) then
		SetGlueScreen("login");
		return;
	end

	this.cacheElapsed = this.cacheElapsed + elapsed;
	CreditsFrame_UpdateCache();

	CreditsScrollFrame:SetVerticalScroll(CreditsScrollFrame.scroll);
	CreditsFrame_UpdateArt(ceil(this.artCount * (CreditsScrollFrame.scroll / CreditsScrollFrame.scrollMax)), elapsed);
end

function CreditsFrame_OnScrollRangeChanged()
	CreditsScrollFrame.scrollMax = CreditsScrollFrame:GetVerticalScrollRange() + 768;
end

function CreditsFrame_OnKeyDown()
	if ( arg1 == "ESCAPE" ) then
		SetGlueScreen("login");
	elseif ( arg1 == "PRINTSCREEN" ) then
		Screenshot();
	end
end
